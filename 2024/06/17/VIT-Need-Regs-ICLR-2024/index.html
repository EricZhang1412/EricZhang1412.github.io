<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Eric Zhang">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://ericzhang1412.github.io/2024/06/17/vit-need-regs-iclr-2024/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="如何生成有一定可解释性的Attention Map 参考Github Repo: jeonsworld&#x2F;ViT-pytorch  我们先试着跑一跑仓库里的train.py，本人写了一个脚本方便快速运行，作者也提供了预训练权重(.npz)。这里以ViT-B-16的模型为例： 12345678910111213141516171819202122python train.py \    --d">
<meta property="og:type" content="article">
<meta property="og:title" content="VIT_Need_Regs_ICLR_2024">
<meta property="og:url" content="https://ericzhang1412.github.io/2024/06/17/VIT-Need-Regs-ICLR-2024/index.html">
<meta property="og:site_name" content="EZ0328">
<meta property="og:description" content="如何生成有一定可解释性的Attention Map 参考Github Repo: jeonsworld&#x2F;ViT-pytorch  我们先试着跑一跑仓库里的train.py，本人写了一个脚本方便快速运行，作者也提供了预训练权重(.npz)。这里以ViT-B-16的模型为例： 12345678910111213141516171819202122python train.py \    --d">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ericzhang1412.github.io/2024/06/17/VIT-Need-Regs-ICLR-2024/output_image.png">
<meta property="og:image" content="https://ericzhang1412.github.io/2024/06/17/VIT-Need-Regs-ICLR-2024/net_struct.png">
<meta property="og:image" content="https://ericzhang1412.github.io/2024/06/17/VIT-Need-Regs-ICLR-2024/VIT-Need-Regs-ICLR-2024/stack_and_squeeze.png">
<meta property="article:published_time" content="2024-06-17T05:39:54.000Z">
<meta property="article:modified_time" content="2024-06-28T14:45:29.892Z">
<meta property="article:author" content="Eric Zhang">
<meta property="article:tag" content="前沿论文阅读">
<meta property="article:tag" content="ViT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ericzhang1412.github.io/2024/06/17/VIT-Need-Regs-ICLR-2024/output_image.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://static.igem.org/mediawiki/2019/7/7f/T--UESTC-China--logo1.jpg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://static.igem.org/mediawiki/2019/7/7f/T--UESTC-China--logo1.jpg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="https://static.igem.org/mediawiki/2019/7/7f/T--UESTC-China--logo1.jpg">
    <!--- Page Info-->
    
    <title>
        
            VIT_Need_Regs_ICLR_2024 -
        
        Eric&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"ericzhang1412.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left"},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://images7.alphacoders.com/119/1199487.jpg","dark":"https://images5.alphacoders.com/117/1172701.jpg"},"title":"Be Creative, Be Critical","subtitle":{"text":[],"hitokoto":{"enable":true,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"links":{"github":"https://github.com/EricZhang1412","instagram":null,"zhihu":null,"twitter":null,"email":"ericzhang0328@outlook.com"},"qrs":{"weixin":"https://picdm.sunbangyan.cn/2023/12/03/5055d7dcce9c5672cefeaba07e72bb8e.jpeg","qq":"https://picdl.sunbangyan.cn/2023/12/04/6dd5f0851b45a00b29d68647bf4458ab.jpeg"}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":true,"type":"fixed","audios":[{"name":"Ones Who Strive to Live","artist":"HOYO-MIX","url":"http://music.163.com/song/media/outer/url?id=1879108727.mp3","cover":"https://pic1.zhimg.com/80/v2-d63097edf33f2ee1d41fefaa03929f44_720w.webp"},{"name":"The Mysterious Islands","artist":"HOYO-MIX","url":"http://music.163.com/song/media/outer/url?id=1879098360.mp3","cover":"https://upload-bbs.miyoushe.com/upload/2021/07/23/197727990/18e0b1137faf800b9efa6608af75bbfb_3549637610788436033.jpg"},{"name":"Lingering Blossom","artist":"HOYO-MIX","url":"http://music.163.com/song/media/outer/url?id=1879108667.mp3","cover":"https://ts1.cn.mm.bing.net/th/id/R-C.5a371823dea937cb48363e307d7381f8?rik=XuuXZbrp8YRMPA&riu=http%3a%2f%2fimg.kuai8.com%2farticle%2fimage%2f202107%2f12%2fc405d1d656.jpg&ehk=TjkTo7He%2bM51LAN3sfdWcrF8Ed7nR2FrT6ULZ2oJkFY%3d&risl=&pid=ImgRaw&r=0"},{"name":"Dream of White Branches","artist":"HOYO-MIX","url":"http://music.163.com/song/media/outer/url?id=2068982800.mp3","cover":"https://y.qq.com/music/photo_new/T002R300x300M000002LoikR0BEwlv_1.jpg?max_age=2592000"}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.5.6","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/EricZhang1412","Blog":"https://ericzhang1412.github.io/"}},"Friends":{"icon":"fa-solid fa-link","path":"/links/"},"Links":{"icon":"fa-regular fa-link","submenus":{"ChatGPT":"https://chat.openai.com/chat","BiliBili":"https://www.bilibili.com/","UESTC":"https://eportal.uestc.edu.cn/new/index.html?browser=no","Software_Download":"https://mp.weixin.qq.com/mp/homepage?__biz=Mzg4OTk3MTI5Mg==&hid=4&sn=81741e58ba13cf90e4aa3cea7d64757b&scene=18","HonkerAllaince":"https://www.honkeralliance.com/zyxz","Z-Library":"https://zh.z-library.se/?afterGeoRedirection=1"}}},"search":{"enable":true,"preload":true},"tags":{"Tags":{"path":"/tags","icon":"fa-regular fa-tags"}}},"page_templates":{"friends_column":3,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"Undergraduate of UESTC,SICE,Department of IoT","links":null,"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}},"article_date_format":"YYYY-MM-DD","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/8/17 11:45:14"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.2.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="swup-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Eric&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        首页
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        归档
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        关于&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/EricZhang1412">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a href="https://ericzhang1412.github.io/">BLOG
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/links/"  >
                                    
                                        
                                            <i class="fa-solid fa-link"></i>
                                        
                                        友情链接
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-link"></i>
                                        
                                        链接&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://chat.openai.com/chat">CHATGPT
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://www.bilibili.com/">BILIBILI
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://eportal.uestc.edu.cn/new/index.html?browser=no">UESTC
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/mp/homepage?__biz=Mzg4OTk3MTI5Mg==&hid=4&sn=81741e58ba13cf90e4aa3cea7d64757b&scene=18">SOFTWARE_DOWNLOAD
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://www.honkeralliance.com/zyxz">HONKERALLAINCE
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://zh.z-library.se/?afterGeoRedirection=1">Z-LIBRARY
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer w-full absolute top-0 left-0 bg-background-color">
        <ul class="drawer-navbar-list flex flex-col justify-start items-center">
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                首页
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                归档
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                关于&nbsp;<i class="group-hover:rotate-180 transition-transform fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" href="/about">ME</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://github.com/EricZhang1412">GITHUB</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" href="https://ericzhang1412.github.io/">BLOG</a>
                            </li>
                        
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/links/"  >
                             
                                
                                    <i class="fa-solid fa-link"></i>
                                
                                友情链接
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-link"></i>
                                
                                链接&nbsp;<i class="group-hover:rotate-180 transition-transform fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://chat.openai.com/chat">CHATGPT</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://www.bilibili.com/">BILIBILI</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://eportal.uestc.edu.cn/new/index.html?browser=no">UESTC</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://mp.weixin.qq.com/mp/homepage?__biz=Mzg4OTk3MTI5Mg==&hid=4&sn=81741e58ba13cf90e4aa3cea7d64757b&scene=18">SOFTWARE_DOWNLOAD</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://www.honkeralliance.com/zyxz">HONKERALLAINCE</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://zh.z-library.se/?afterGeoRedirection=1">Z-LIBRARY</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color text-4xl md:text-6xl font-bold px-2 sm:px-6 md:px-8 py-3">VIT_Need_Regs_ICLR_2024</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="https://s21.ax1x.com/2024/04/29/pkF81Gq.png">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Eric Zhang</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-06-17 13:39:54</span>
        <span class="mobile">2024-06-17 13:39:54</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-06-28 22:45:29</span>
            <span class="mobile">2024-06-28 22:45:29</span>
            <span class="hover-info">更新</span>
        </span>
    

    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%89%8D%E6%B2%BF%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">前沿论文阅读</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/ViT/">ViT</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h2 id="如何生成有一定可解释性的attention-map">如何生成有一定可解释性的Attention
Map</h2>
<p>参考Github Repo: <a class="link" target="_blank" rel="noopener" href="https://github.com/jeonsworld/ViT-pytorch">jeonsworld/ViT-pytorch <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>我们先试着跑一跑仓库里的train.py，本人写了一个脚本方便快速运行，作者也提供了预训练权重(.npz)。这里以ViT-B-16的模型为例：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">python train.py \</span><br><span class="line">    --dataset cifar10 \</span><br><span class="line">    --model_type ViT-B_16 \</span><br><span class="line">    --pretrained_dir "checkpoint/imagenet21k+imagenet2012_ViT-B_16.npz" \</span><br><span class="line">    --output_dir "./outputs" \</span><br><span class="line">    --img_size 224 \</span><br><span class="line">    --train_batch_size 256 \</span><br><span class="line">    --eval_batch_size 4 \</span><br><span class="line">    --name "exp_1" \</span><br><span class="line">    --eval_every 100 \</span><br><span class="line">    --learning_rate 3e-2 \</span><br><span class="line">    --weight_decay 0 \</span><br><span class="line">    --num_steps 10000 \</span><br><span class="line">    --decay_type cosine \</span><br><span class="line">    --warmup_steps 500 \</span><br><span class="line">    --max_grad_norm 1.0 \</span><br><span class="line">    --local_rank -1 \</span><br><span class="line">    --seed 42 \</span><br><span class="line">    --gradient_accumulation_steps 1 \</span><br><span class="line">    --fp16 \</span><br><span class="line">    --fp16_opt_level O2 \</span><br><span class="line">    --loss_scale 0</span><br></pre></td></tr></table></figure></div>
<p>实践证明是能跑的，成功了第一步。</p>
<p>下面就着重研究如何可视化.</p>
<p>首先放出可视化脚本的代码:</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> typing</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlretrieve</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> models.modeling <span class="keyword">import</span> VisionTransformer, CONFIGS</span><br><span class="line"></span><br><span class="line">os.makedirs(<span class="string">"attention_data"</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(<span class="string">"attention_data/ilsvrc2012_wordnet_lemmas.txt"</span>):</span><br><span class="line">    urlretrieve(<span class="string">"https://storage.googleapis.com/bit_models/ilsvrc2012_wordnet_lemmas.txt"</span>, <span class="string">"attention_data/ilsvrc2012_wordnet_lemmas.txt"</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(<span class="string">"attention_data/ViT-B_16-224.npz"</span>):</span><br><span class="line">    urlretrieve(<span class="string">"https://storage.googleapis.com/vit_models/imagenet21k+imagenet2012/ViT-B_16-224.npz"</span>, <span class="string">"attention_data/ViT-B_16-224.npz"</span>)</span><br><span class="line"></span><br><span class="line">imagenet_labels = <span class="built_in">dict</span>(<span class="built_in">enumerate</span>(<span class="built_in">open</span>(<span class="string">'attention_data/ilsvrc2012_wordnet_lemmas.txt'</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># # Test Image</span></span><br><span class="line"><span class="comment"># img_url = "https://images.mypetlife.co.kr/content/uploads/2019/04/09192811/welsh-corgi-1581119_960_720.jpg"</span></span><br><span class="line"><span class="comment"># urlretrieve(img_url, "attention_data/img.jpg")</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare Model</span></span><br><span class="line">config = CONFIGS[<span class="string">"ViT-B_16"</span>]</span><br><span class="line">model = VisionTransformer(config, num_classes=<span class="number">1000</span>, zero_head=<span class="literal">False</span>, img_size=<span class="number">224</span>, vis=<span class="literal">True</span>)</span><br><span class="line">model.load_from(np.load(<span class="string">"attention_data/ViT-B_16-224.npz"</span>))</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">transform = transforms.Compose([</span><br><span class="line">    transforms.Resize((<span class="number">224</span>, <span class="number">224</span>)),</span><br><span class="line">    transforms.ToTensor(),</span><br><span class="line">    transforms.Normalize(mean=[<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>], std=[<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>]),</span><br><span class="line">])</span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">"/data/dataset/ImageNet/train/n01440764/n01440764_10026.JPEG"</span>)</span><br><span class="line">x = transform(im)</span><br><span class="line"></span><br><span class="line">logits, att_mat = model(x.unsqueeze(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">att_mat = torch.stack(att_mat).squeeze(<span class="number">1</span>) <span class="comment"># torch.stack()进行扩维拼接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Average the attention weights across all heads.</span></span><br><span class="line">att_mat = torch.mean(att_mat, dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># To account for residual connections, we add an identity matrix to the</span></span><br><span class="line"><span class="comment"># attention matrix and re-normalize the weights.</span></span><br><span class="line">residual_att = torch.eye(att_mat.size(<span class="number">1</span>))</span><br><span class="line">aug_att_mat = att_mat + residual_att</span><br><span class="line">aug_att_mat = aug_att_mat / aug_att_mat.<span class="built_in">sum</span>(dim=-<span class="number">1</span>).unsqueeze(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursively multiply the weight matrices</span></span><br><span class="line">joint_attentions = torch.zeros(aug_att_mat.size())</span><br><span class="line">joint_attentions[<span class="number">0</span>] = aug_att_mat[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, aug_att_mat.size(<span class="number">0</span>)):</span><br><span class="line">    joint_attentions[n] = torch.matmul(aug_att_mat[n], joint_attentions[n-<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line"><span class="comment"># Attention from the output token to the input space.</span></span><br><span class="line">v = joint_attentions[-<span class="number">1</span>]</span><br><span class="line">grid_size = <span class="built_in">int</span>(np.sqrt(aug_att_mat.size(-<span class="number">1</span>)))</span><br><span class="line">mask = v[<span class="number">0</span>, <span class="number">1</span>:].reshape(grid_size, grid_size).detach().numpy()</span><br><span class="line">mask = cv2.resize(mask / mask.<span class="built_in">max</span>(), im.size)[..., np.newaxis]</span><br><span class="line">result = (mask * im).astype(<span class="string">"uint8"</span>)</span><br><span class="line"></span><br><span class="line">fig, (ax1, ax2) = plt.subplots(ncols=<span class="number">2</span>, figsize=(<span class="number">16</span>, <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">ax1.set_title(<span class="string">'Original'</span>)</span><br><span class="line">ax2.set_title(<span class="string">'Attention Map'</span>)</span><br><span class="line">_ = ax1.imshow(im)</span><br><span class="line">_ = ax2.imshow(result)</span><br><span class="line"></span><br><span class="line">fig.savefig(<span class="string">'output_image.png'</span>)</span><br><span class="line"></span><br><span class="line">probs = torch.nn.Softmax(dim=-<span class="number">1</span>)(logits)</span><br><span class="line">top5 = torch.argsort(probs, dim=-<span class="number">1</span>, descending=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Prediction Label and Attention Map!\n"</span>)</span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> top5[<span class="number">0</span>, :<span class="number">5</span>]:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'<span class="subst">{probs[<span class="number">0</span>, idx.item()]:<span class="number">.5</span>f}</span> : <span class="subst">{imagenet_labels[idx.item()]}</span>'</span>, end=<span class="string">''</span>)</span><br></pre></td></tr></table></figure></div>
<p>生成的图片长这样: <img lazyload src="/images/loading.svg" data-src="output_image.png" alt="output_image"></p>
<p>我们详细看看可视化代码里干了什么事情。</p>
<p>前期的网络处理流程如下图所示。 <img lazyload src="/images/loading.svg" data-src="net_struct.png" alt="ViT_Base_16 Net Structure"></p>
<p>核心部分处理score matrix 和Attention map的代码如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logits, att_mat = model(x.unsqueeze(<span class="number">0</span>))</span><br></pre></td></tr></table></figure></div>
<p>此行代码预测并获取注意力矩阵,
此时若运行<code>print(len(att_mat))</code>,
我们会得到输出为<code>12</code>，代表模型输出的Attention
Map共有12个。这个数字与Transformer Encoder
Block的个数是一致的。即Transformer强制要求输入输出为同一维度，这样才可以级联好多个Transformer块进行不断地网络学习与拟合。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">att_mat = torch.stack(att_mat).squeeze(<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<p>这是在对attention map
list进行拼接，降维处理。这里给出<code>torch.stack</code> API的用法：
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">torch.stack(tensors, dim=0, *, out=None) → Tensor</span><br><span class="line">    Concatenates a sequence of tensors along a new dimension.</span><br><span class="line">    All tensors need to be of the same size.</span><br><span class="line">SEE ALSO</span><br><span class="line">    torch.cat(): concatenates the given sequence along an existing dimension.</span><br><span class="line">* Parameters: </span><br><span class="line">    tensors (sequence of Tensors) – sequence of tensors to concatenate</span><br><span class="line">    dim (int, optional) – dimension to insert. Has to be between 0 and the number of dimensions of concatenated tensors (inclusive). Default: 0</span><br><span class="line">* Keyword Arguments</span><br><span class="line">    out (Tensor, optional) – the output tensor.</span><br></pre></td></tr></table></figure></div>
不传入dim参数时默认为0，故将这个list以第1个维度进行拼接。之后再进行<code>squeeze(1)</code>操作，得到的是除去指定位置的维数为1的维度输出（这里比较绕QAQ）。运行<code>print(att_mat.shape)</code>,得到的输出是<code>torch.Size([12, 12, 197, 197])</code>。</p>
<p>我猜测的数据流是这样的： <img lazyload src="/images/loading.svg" data-src="VIT-Need-Regs-ICLR-2024/stack_and_squeeze.png" alt="Stack and Squeeze"></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">att_mat = torch.mean(att_mat, dim=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<p>按照第二个维度（12）进行均值计算，最后得到的理论上是12张一样的平均过后的attention
map。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">residual_att = torch.eye(att_mat.size(<span class="number">1</span>))</span><br><span class="line">aug_att_mat = att_mat + residual_att</span><br><span class="line">aug_att_mat = aug_att_mat / aug_att_mat.<span class="built_in">sum</span>(dim=-<span class="number">1</span>).unsqueeze(-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<p>在 ViT 中，注意力矩阵 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewbox="0 -716 750 716"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"/></g></g></g></svg></mjx-container></span>
表示每个token对其他token的注意力权重。通过添加单位矩阵 <span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.14ex" height="1.545ex" role="img" focusable="false" viewbox="0 -683 504 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"/></g></g></g></svg></mjx-container></span>：<span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.452ex;" xmlns="http://www.w3.org/2000/svg" width="35.294ex" height="2.149ex" role="img" focusable="false" viewbox="0 -750 15600 950"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="merror" data-mjx-error="'_' allowed only in math mode" title="'_' allowed only in math mode"><rect data-background="true" width="15600" height="950" y="-200"/><title>'_' allowed only in math mode</title><g data-mml-node="mtext" style="font-family: serif;"><text data-variant="-explicitFont" transform="scale(1,-1)" font-size="884px">aug_{\textbf{att_mat}}=A+I</text></g></g></g></g></svg></mjx-container></span>. 其中，<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.14ex" height="1.545ex" role="img" focusable="false" viewbox="0 -683 504 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"/></g></g></g></svg></mjx-container></span>
是一个单位矩阵（对角线上元素为1，其他元素为0），我们确保了每个token对自己的注意力权重至少为1。这种方式可以看作是残差连接的一种形式，它保证了每个token的原始信息在经过多个注意力层后仍能保留。(来源：ChatGPT)</p>

        </div>

        
            <div class="post-copyright-info my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> VIT_Need_Regs_ICLR_2024</li>
        <li><strong>作者:</strong> Eric Zhang</li>
        <li><strong>创建于
                :</strong> 2024-06-17 13:39:54</li>
        
            <li>
                <strong>更新于
                    :</strong> 2024-06-28 22:45:29
            </li>
        
        <li>
            <strong>链接:</strong> https://ericzhang1412.github.io/2024/06/17/VIT-Need-Regs-ICLR-2024/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/%E5%89%8D%E6%B2%BF%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">#前沿论文阅读</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/ViT/">#ViT</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2024/06/17/STELLAR-HPCA-2024/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">STELLAR_HPCA_2024</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2024/04/30/FireFly-v1-FPGA-Simulation/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">FireFly-v1-FPGA Simulation</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container pjax">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fa-solid fa-comments"></i>&nbsp;评论
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://blog-comments-9q2oiy1rg-ericzhang1412.vercel.app/',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          requiredMeta: ['nick', 'mail']
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">此页目录</div>
        <div class="page-title">VIT_Need_Regs_ICLR_2024</div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E7%94%9F%E6%88%90%E6%9C%89%E4%B8%80%E5%AE%9A%E5%8F%AF%E8%A7%A3%E9%87%8A%E6%80%A7%E7%9A%84attention-map"><span class="nav-text">如何生成有一定可解释性的Attention
Map</span></a></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Eric Zhang</a>
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.5.6</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>



    
<script src="/js/tools/localSearch.js" type="module"></script>




    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>




    
<script src="/js/libs/mermaid.min.js"></script>

    
<script src="/js/plugins/mermaid.js"></script>





<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/libs/anime.min.js"></script>

        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


    <div id="aplayer"></div>

<script src="/js/libs/APlayer.min.js"></script>


<script src="/js/plugins/aplayer.js"></script>


</body>
</html>
