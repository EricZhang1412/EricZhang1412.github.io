<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Eric Zhang">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://ericzhang1412.github.io/2024/04/30/arm-linux-mqtt/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="在ZYNQ 7020 PS端使用paho.mqtt实现设备侧开发连接华为云IoTDA服务（2024-2025第六学期综合课程设计自主设计任务的一环） 参考资料 https:&#x2F;&#x2F;blog.csdn.net&#x2F;thisway_diy&#x2F;article&#x2F;details&#x2F;125557534 , 【嵌入式Linux应用】初步移植MQTT到Ubuntu和Linux开发板, 韦东山  https:&#x2F;&#x2F;www.cnb">
<meta property="og:type" content="article">
<meta property="og:title" content="ARM-Linux-MQTT移植">
<meta property="og:url" content="https://ericzhang1412.github.io/2024/04/30/arm-linux-mqtt/index.html">
<meta property="og:site_name" content="EZ0328">
<meta property="og:description" content="在ZYNQ 7020 PS端使用paho.mqtt实现设备侧开发连接华为云IoTDA服务（2024-2025第六学期综合课程设计自主设计任务的一环） 参考资料 https:&#x2F;&#x2F;blog.csdn.net&#x2F;thisway_diy&#x2F;article&#x2F;details&#x2F;125557534 , 【嵌入式Linux应用】初步移植MQTT到Ubuntu和Linux开发板, 韦东山  https:&#x2F;&#x2F;www.cnb">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ericzhang1412.github.io/2024/04/30/arm-linux-mqtt/mqtt_version_compare.png">
<meta property="og:image" content="https://ericzhang1412.github.io/2024/04/30/arm-linux-mqtt/mqtt_c_test.png">
<meta property="article:published_time" content="2024-04-29T16:03:50.000Z">
<meta property="article:modified_time" content="2024-04-29T18:38:13.651Z">
<meta property="article:author" content="Eric Zhang">
<meta property="article:tag" content="MQTT">
<meta property="article:tag" content="ARM">
<meta property="article:tag" content="ZYNQ">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ericzhang1412.github.io/2024/04/30/arm-linux-mqtt/mqtt_version_compare.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://static.igem.org/mediawiki/2019/7/7f/T--UESTC-China--logo1.jpg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://static.igem.org/mediawiki/2019/7/7f/T--UESTC-China--logo1.jpg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="https://static.igem.org/mediawiki/2019/7/7f/T--UESTC-China--logo1.jpg">
    <!--- Page Info-->
    
    <title>
        
            ARM-Linux-MQTT移植 -
        
        Eric&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"ericzhang1412.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left"},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://images7.alphacoders.com/119/1199487.jpg","dark":"https://images5.alphacoders.com/117/1172701.jpg"},"title":"Be Creative, Be Critical","subtitle":{"text":[],"hitokoto":{"enable":true,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"links":{"github":"https://github.com/EricZhang1412","instagram":null,"zhihu":null,"twitter":null,"email":"ericzhang0328@outlook.com"},"qrs":{"weixin":"https://picdm.sunbangyan.cn/2023/12/03/5055d7dcce9c5672cefeaba07e72bb8e.jpeg","qq":"https://picdl.sunbangyan.cn/2023/12/04/6dd5f0851b45a00b29d68647bf4458ab.jpeg"}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":true,"type":"fixed","audios":[{"name":"Ones Who Strive to Live","artist":"HOYO-MIX","url":"http://music.163.com/song/media/outer/url?id=1879108727.mp3","cover":"https://pic1.zhimg.com/80/v2-d63097edf33f2ee1d41fefaa03929f44_720w.webp"},{"name":"The Mysterious Islands","artist":"HOYO-MIX","url":"http://music.163.com/song/media/outer/url?id=1879098360.mp3","cover":"https://upload-bbs.miyoushe.com/upload/2021/07/23/197727990/18e0b1137faf800b9efa6608af75bbfb_3549637610788436033.jpg"},{"name":"Lingering Blossom","artist":"HOYO-MIX","url":"http://music.163.com/song/media/outer/url?id=1879108667.mp3","cover":"https://ts1.cn.mm.bing.net/th/id/R-C.5a371823dea937cb48363e307d7381f8?rik=XuuXZbrp8YRMPA&riu=http%3a%2f%2fimg.kuai8.com%2farticle%2fimage%2f202107%2f12%2fc405d1d656.jpg&ehk=TjkTo7He%2bM51LAN3sfdWcrF8Ed7nR2FrT6ULZ2oJkFY%3d&risl=&pid=ImgRaw&r=0"},{"name":"Dream of White Branches","artist":"HOYO-MIX","url":"http://music.163.com/song/media/outer/url?id=2068982800.mp3","cover":"https://y.qq.com/music/photo_new/T002R300x300M000002LoikR0BEwlv_1.jpg?max_age=2592000"}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.5.6","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/EricZhang1412","Blog":"https://ericzhang1412.github.io/"}},"Friends":{"icon":"fa-solid fa-link","path":"/links/"},"Links":{"icon":"fa-regular fa-link","submenus":{"ChatGPT":"https://chat.openai.com/chat","BiliBili":"https://www.bilibili.com/","UESTC":"https://eportal.uestc.edu.cn/new/index.html?browser=no","Software_Download":"https://mp.weixin.qq.com/mp/homepage?__biz=MzkzNDI4MTg3Nw==&hid=6&sn=9f9fddc2ce01ab44fbf63b70c273d7d6&scene=18","HonkerAllaince":"https://www.honkeralliance.com/zyxz"}}},"search":{"enable":true,"preload":true},"tags":{"Tags":{"path":"/tags","icon":"fa-regular fa-tags"}}},"page_templates":{"friends_column":3,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"Undergraduate of UESTC,SICE,Department of IoT","links":null,"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}},"article_date_format":"YYYY-MM-DD","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/8/17 11:45:14"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="swup-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Eric&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        首页
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        归档
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        关于&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/EricZhang1412">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a href="https://ericzhang1412.github.io/">BLOG
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/links/"  >
                                    
                                        
                                            <i class="fa-solid fa-link"></i>
                                        
                                        友情链接
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-link"></i>
                                        
                                        链接&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://chat.openai.com/chat">CHATGPT
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://www.bilibili.com/">BILIBILI
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://eportal.uestc.edu.cn/new/index.html?browser=no">UESTC
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/mp/homepage?__biz=MzkzNDI4MTg3Nw==&hid=6&sn=9f9fddc2ce01ab44fbf63b70c273d7d6&scene=18">SOFTWARE_DOWNLOAD
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://www.honkeralliance.com/zyxz">HONKERALLAINCE
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer w-full absolute top-0 left-0 bg-background-color">
        <ul class="drawer-navbar-list flex flex-col justify-start items-center">
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                首页
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                归档
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                关于&nbsp;<i class="group-hover:rotate-180 transition-transform fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" href="/about">ME</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://github.com/EricZhang1412">GITHUB</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" href="https://ericzhang1412.github.io/">BLOG</a>
                            </li>
                        
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/links/"  >
                             
                                
                                    <i class="fa-solid fa-link"></i>
                                
                                友情链接
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-link"></i>
                                
                                链接&nbsp;<i class="group-hover:rotate-180 transition-transform fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://chat.openai.com/chat">CHATGPT</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://www.bilibili.com/">BILIBILI</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://eportal.uestc.edu.cn/new/index.html?browser=no">UESTC</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://mp.weixin.qq.com/mp/homepage?__biz=MzkzNDI4MTg3Nw==&hid=6&sn=9f9fddc2ce01ab44fbf63b70c273d7d6&scene=18">SOFTWARE_DOWNLOAD</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://www.honkeralliance.com/zyxz">HONKERALLAINCE</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color text-4xl md:text-6xl font-bold px-2 sm:px-6 md:px-8 py-3">ARM-Linux-MQTT移植</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="https://s21.ax1x.com/2024/04/29/pkF81Gq.png">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Eric Zhang</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-04-30 00:03:50</span>
        <span class="mobile">2024-04-30 00:03:50</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-04-30 02:38:13</span>
            <span class="mobile">2024-04-30 02:38:13</span>
            <span class="hover-info">更新</span>
        </span>
    

    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/MQTT/">MQTT</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/ARM/">ARM</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/ZYNQ/">ZYNQ</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Linux/">Linux</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h2 id="在ZYNQ-7020-PS端使用paho-mqtt实现设备侧开发连接华为云IoTDA服务"><a href="#在ZYNQ-7020-PS端使用paho-mqtt实现设备侧开发连接华为云IoTDA服务" class="headerlink" title="在ZYNQ 7020 PS端使用paho.mqtt实现设备侧开发连接华为云IoTDA服务"></a>在ZYNQ 7020 PS端使用paho.mqtt实现设备侧开发连接华为云IoTDA服务</h2><p>（2024-2025第六学期综合课程设计自主设计任务的一环）</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol>
<li><p><a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/thisway_diy/article/details/125557534">https://blog.csdn.net/thisway_diy/article/details/125557534 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>, 【嵌入式Linux应用】初步移植MQTT到Ubuntu和Linux开发板, 韦东山</p>
</li>
<li><p><a class="link" target="_blank" rel="noopener" href="https://www.cnblogs.com/wanqieddy/archive/2011/09/21/2184257.html">https://www.cnblogs.com/wanqieddy/archive/2011/09/21/2184257.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>, Makefile 中:&#x3D; ?&#x3D; +&#x3D; &#x3D;的区别, wanqi</p>
</li>
<li><p><a class="link" target="_blank" rel="noopener" href="https://support.huaweicloud.com/devg-iothub/iot_02_2200.html">https://support.huaweicloud.com/devg-iothub/iot_02_2200.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>, MQTT使用指导, 华为云</p>
</li>
</ol>
<h3 id="0-Ubuntu18-04-WSL准备"><a href="#0-Ubuntu18-04-WSL准备" class="headerlink" title="0. Ubuntu18.04 WSL准备"></a>0. Ubuntu18.04 WSL准备</h3><p>教程很多有手就行。</p>
<h3 id="1-前置包准备"><a href="#1-前置包准备" class="headerlink" title="1. 前置包准备"></a>1. 前置包准备</h3><p>Paho MQTT的包对多种语言都有支持，其中特别是嵌入式设备中（之前bz用过海斯Hi3861的paho-embedded-mqtt，是工程师事先构建好在OpenHarmony镜像中，用户层面一般操作不到底层（也可能是本人菜qaq））有一个版本是Embedded-C&#x2F;C++。相比于标准C&#x2F;C++库，Embedded版本特意删减了嵌入式设备不常用的几个功能。但如果要在嵌入式Linux设备上板端部署，标准C和Embedded-C都可以，这里选取标准C语言库。</p>
<h2 id><a href="#" class="headerlink" title></a><img lazyload src="/images/loading.svg" data-src="/2024/04/30/arm-linux-mqtt/mqtt_version_compare.png" alt="图1：Paho-MQTT不同语言支持包的功能比较"></h2><p>Paho-MQTT-C支持包：</p>
<pre><code>https://github.com/eclipse/paho.mqtt.c.git
</code></pre>
<p>openssl1.1.1v库：</p>
<pre><code>https://github.com/openssl/openssl/releases/download/OpenSSL_1_1_1v/openssl-1.1.1v.tar.gz
</code></pre>
<p>在<code>/home/&#123;$USER&#125;</code>目录下新建一个工作区<code>paho_test</code>用来保存工程和开发资料：(其实也不是很必要，找个文件夹放编译文件就行，<strong>注意${USER}换成自己WSL的用户</strong>)</p>
<pre><code>mkdir paho_test
cd paho_test/
mkdir workspace &amp;&amp; cd workspace
mkdir mqtt &amp;&amp; cd mqtt
</code></pre>
<p>在<code>/home/&#123;$USER&#125;/paho_test/workspace/mqtt</code>下将paho-mqtt的仓库克隆下来(master分支就行)</p>
<pre><code>git clone https://github.com/eclipse/paho.mqtt.c.git
</code></pre>
<p>先别急搞交叉编译，我们先验证一下paho-mqtt能否建立MQTT通信。</p>
<p>在<code>/home/&#123;$USER&#125;/paho_test/workspace/mqtt/paho.mqtt.c</code>目录下执行下面两条命令</p>
<pre><code>make -j16
&lt;!-- j16表示调用16线程，可选，编译速度会更快，但也会极小概率编出问题，一般不用在意 --&gt;
sudo make install
</code></pre>
<p>执行make后会在当前目录下创建一个build目录，源码和例程编译出来的可执行文件都在里面；执行sudo make install,会将mqtt程序依赖的库文件安装到&#x2F;usr&#x2F;local下的bin、lib、include和share下。(路径是由Makefile指定)</p>
<p>下面，在<code>/home/&#123;$USER&#125;/paho_test/workspace/</code>目录下新建一个测试工程，取名就叫<code>mqtt_test</code>：</p>
<pre><code>cd /home/&#123;$USER&#125;/paho_test/workspace/
mkdir mqtt_test
cd mqtt_test
</code></pre>
<p>将paho.mqtt.c下的src和sample里面的随意一个示例代码copy过来：</p>
<pre><code>cp -r /home/&#123;$USER&#125;/paho_test/workspace/mqtt/paho.mqtt.c/src ./
cp /home/&#123;$USER&#125;/paho_test/workspace/mqtt/paho.mqtt.c/src/samples/MQTTClient_publish.c  ./
</code></pre>
<p>我们这里copy的是MQTTClient开头的例程，其表示的是MQTT的客户端发布，依赖的库是libpaho-mqtt3c，如果是MQTTAsync开头的，依赖的库就是libpaho-mqtt3a，如果自己写代码还会用到SSL的话，依赖的库就会变成libpaho-mqt3cs或者ibpaho-mqtt3as。如何确定使用的是Async还是Client呢，根据自己写的代码里面包含的头文件是MQTTAsync.h还是MQTTClient.h，比如我刚才copy的例程MQTTClient_publish.c：</p>
<pre><code class="c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &quot;MQTTClient.h&quot;  // &lt;----这里调用Client头文件
</code></pre>
<p>现在来修改这个示例代码。首先是头文件MQTTClient.h，我们需要指定路径，不然在当前目录下是找不到这个头文件的，我们已经将这个头文件所在的官方源文件文件夹 src copy过来了，所以只需要改成：</p>
<pre><code class="c">#include &quot;src/MQTTClient.h&quot; 
</code></pre>
<p>然后修改url, 客户端id, ADDRESS和CLIENTID以及订阅的TOPIC，还要添加华为云物联网平台设备的用户名USERNAME和密码PASSWORD：</p>
<p>以下面的华为云设备接入信息为例：</p>
<pre><code>&#123;
    &quot;username&quot;: &quot;6620c62c2ccc1a583881d5fb_cc2530&quot;,
    &quot;password&quot;: &quot;6e7ff9829d7b19dcfd837930c26cd81ac293e8080950b931c44b9a0b92b3e767&quot;,
    &quot;clientId&quot;: &quot;6620c62c2ccc1a583881d5fb_cc2530_0_0_2024042508&quot;,
    &quot;hostname&quot;: &quot;3c1ab378e9.st1.iotda-device.cn-north-4.myhuaweicloud.com&quot;,
    &quot;port&quot;: 8883,
    &quot;protocol&quot;: &quot;MQTTS&quot;
&#125;
</code></pre>
<p>原始代码改成：</p>
<pre><code class="c">#define ADDRESS     &quot;mqtt://xxxx.com:1883&quot;
#define CLIENTID    &quot;6620c6xxx_xxxx_x_x_202xxxxx08&quot;
#define USERNAME    &quot;6620c62c2xxxxx_ccxxxx&quot;
#define PASSWORD    &quot;6e7ff9829xxxxxx293exxx095xxxxx9a0b92b3e767&quot;
#define TOPIC       &quot;MQTT Examples&quot;
#define PAYLOAD     &quot;Hello World!&quot;
#define QOS         1
#define TIMEOUT     10000L
</code></pre>
<p>将连接控制包的keepAliveInterval设置为大于等于60的值（以90为例）(<strong>一定要改，不然会报奇奇怪怪的错</strong>)，并且对控制包的用户名username和密码password赋值为我们宏定义的值：</p>
<pre><code class="c">int main(int argc, char* argv[])
&#123;
    MQTTClient client;
    MQTTClient_connectOptions conn_opts = MQTTClient_connectOptions_initializer;
    conn_opts.username = USERNAME; // &lt;--对应设备接入文件USERNAME
    conn_opts.password = PASSWORD; // &lt;--对应设备接入文件PASSWORD
    MQTTClient_message pubmsg = MQTTClient_message_initializer;
    MQTTClient_deliveryToken token;
    int rc;

    if ((rc = MQTTClient_create(&amp;client, ADDRESS, CLIENTID,
        MQTTCLIENT_PERSISTENCE_NONE, NULL)) != MQTTCLIENT_SUCCESS)
    &#123;
         printf(&quot;Failed to create client, return code %d\n&quot;, rc);
         exit(EXIT_FAILURE);
    &#125;

    conn_opts.keepAliveInterval = 90;// &lt;--更改keepAliveInterval值
    conn_opts.cleansession = 1;
    if ((rc = MQTTClient_connect(client, &amp;conn_opts)) != MQTTCLIENT_SUCCESS)
    &#123;
        printf(&quot;Failed to connect, return code %d\n&quot;, rc);
        exit(EXIT_FAILURE);
    &#125;
</code></pre>
<p>保存退出<code>ESC</code>-&gt;<code>:wq</code></p>
<p>编译修改之后的MQTTClient_publish.c:</p>
<pre><code>gcc MQTTAsync_subscribe.c -lpaho-mqtt3c
ls
---&gt; a.out  MQTTAsync_subscribe.c  src
</code></pre>
<p>可以看到生成了一个a.out，我们执行整个文件：</p>
<pre><code>./a.out 
</code></pre>
<p>如果连接成功了且订阅也成功了会打印如下信息：</p>
<pre><code>Waiting for up to 10 seconds for publication of Hello World!
on topic MQTT Examples for client with ClientID: 6620c6xxx_xxxx_x_x_202xxxxx08
Message with delivery token 1 delivered
</code></pre>
<p>从华为云服务器的控制台消息跟踪也可以看到消息发布成功<br><img lazyload src="/images/loading.svg" data-src="/2024/04/30/arm-linux-mqtt/mqtt_c_test.png" alt="图2：消息上报成功"></p>
<h3 id="2-交叉编译与移植至Zynq-7020-PS端（基于Petalinux）"><a href="#2-交叉编译与移植至Zynq-7020-PS端（基于Petalinux）" class="headerlink" title="2. 交叉编译与移植至Zynq-7020 PS端（基于Petalinux）"></a>2. 交叉编译与移植至Zynq-7020 PS端（基于Petalinux）</h3><p>如果没有构建好Petalinux，请参考以下博客进行镜像构建：<a class="link" target="_blank" rel="noopener" href="https://lostacnet.top/post/31220/">https://lostacnet.top/post/31220/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>检查下编译器是否生效可用：</p>
<pre><code>arm-buildroot-linux-gnueabihf-gcc -v
--&gt;
Using built-in specs.
COLLECT_GCC=arm-linux-gnueabihf-gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc-cross/arm-linux-gnueabihf/7/lto-wrapper
Target: arm-linux-gnueabihf
Configured with: ../src/configure -v --with-pkgversion=&#39;Ubuntu/Linaro 7.5.0-3ubuntu1~18.04&#39; --with-bugurl=file:///usr/share/doc/gcc-7/README.Bugs --enable-languages=c,ada,c++,go,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-7 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-libitm --disable-libquadmath --disable-libquadmath-support --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-multiarch --enable-multilib --disable-sjlj-exceptions --with-arch=armv7-a --with-fpu=vfpv3-d16 --with-float=hard --with-mode=thumb --disable-werror --enable-multilib --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=arm-linux-gnueabihf --program-prefix=arm-linux-gnueabihf- --includedir=/usr/arm-linux-gnueabihf/include
Thread model: posix
gcc version 7.5.0 (Ubuntu/Linaro 7.5.0-3ubuntu1~18.04)
</code></pre>
<p>修改Makefile:</p>
<pre><code class="Makefile">CC = arm-linux-gnueabihf-gcc # Line 126
CCFLAGS_SO += -Wno-deprecated-declarations -DOSX -march=arm # Line 202
LDFLAGS_CS += -Wl,-install_name,lib$(MQTTLIB_CS).so.$&#123;MAJOR_VERSION&#125; -L /home/&#123;$USER&#125;/openssl-arm/lib # Line 204
LDFLAGS_AS += -Wl,-install_name,lib$&#123;MQTTLIB_AS&#125;.so.$&#123;MAJOR_VERSION&#125; -L /home/&#123;$USER&#125;/openssl-arm/lib # Line 206
FLAGS_EXES += -L /home/ericzh/openssl-arm/lib # New
</code></pre>
<p>进行交叉编译：</p>
<pre><code>&lt;!-- 可选make clean，清理之前的编译文件 --&gt;
make -j 16
---&gt;
mkdir -p build/output/samples
mkdir -p build/output/test
mkdir -p build
echo OSTYPE is Linux
sed -e &quot;s/@CLIENT_VERSION@/1.3.13/g&quot; -e &quot;s/@BUILD_TIMESTAMP@/Mon Apr 29 12:35:38 CST 2024/g&quot; src/VersionInfo.h.in &gt; build/VersionInfo.h
OSTYPE is Linux
arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3c.so.1.3 src/Heap.c src/LinkedList.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c src/MQTTClient.c  -shared -Wl,-init,MQTTClient_init -Wl,--start-group -pthread -lanl -Wl,--end-group -Wl,-soname,libpaho-mqtt3c.so.1
# arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3cs.so.1.3 src/Heap.c src/LinkedList.c src/SSLSocket.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c src/MQTTClient.c -DOPENSSL  -shared -Wl,--start-group -pthread -lanl -ldl -lssl -lcrypto -Wl,--end-group -Wl,-init,MQTTClient_init -Wl,-soname,libpaho-mqtt3cs.so.1 -Wl,-no-whole-archive
arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3a.so.1.3 src/Heap.c src/LinkedList.c src/MQTTAsyncUtils.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/MQTTAsync.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c  -shared -Wl,-init,MQTTAsync_init -Wl,--start-group -pthread -lanl -Wl,--end-group -Wl,-soname,libpaho-mqtt3a.so.1
# arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3as.so.1.3 src/Heap.c src/LinkedList.c src/SSLSocket.c src/MQTTAsyncUtils.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/MQTTAsync.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c -DOPENSSL  -shared -Wl,--start-group -pthread -lanl -ldl -lssl -lcrypto -Wl,--end-group -Wl,-init,MQTTAsync_init -Wl,-soname,libpaho-mqtt3as.so.1 -Wl,-no-whole-archive
arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3cs.so.1.3 src/Heap.c src/LinkedList.c src/SSLSocket.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c src/MQTTClient.c  -shared -Wl,--start-group -pthread -lanl -ldl -lssl -lcrypto -Wl,--end-group -Wl,-init,MQTTClient_init -Wl,-soname,libpaho-mqtt3cs.so.1 -Wl,-no-whole-archive
arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3as.so.1.3 src/Heap.c src/LinkedList.c src/SSLSocket.c src/MQTTAsyncUtils.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/MQTTAsync.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c  -shared -Wl,--start-group -pthread -lanl -ldl -lssl -lcrypto -Wl,--end-group -Wl,-init,MQTTAsync_init -Wl,-soname,libpaho-mqtt3as.so.1 -Wl,-no-whole-archive
src/WebSocket.c:124:13: warning: ‘uuid_unparse’ defined but not used [-Wunused-function]
 static void uuid_unparse( uuid_t uu, char *out )
             ^~~~~~~~~~~~
src/WebSocket.c:124:13: warning: ‘uuid_unparse’ defined but not used [-Wunused-function]
 static void uuid_unparse( uuid_t uu, char *out )
             ^~~~~~~~~~~~
src/WebSocket.c:124:13: warning: ‘uuid_unparse’ defined but not used [-Wunused-function]
 static void uuid_unparse( uuid_t uu, char *out )
             ^~~~~~~~~~~~
src/WebSocket.c:124:13: warning: ‘uuid_unparse’ defined but not used [-Wunused-function]
 static void uuid_unparse( uuid_t uu, char *out )
             ^~~~~~~~~~~~
/lib/../lib/libcrypto.so: file not recognized: File format not recognized
collect2: error: ld returned 1 exit status
Makefile:267: recipe for target &#39;build/output/libpaho-mqtt3cs.so.1.3&#39; failed
make: *** [build/output/libpaho-mqtt3cs.so.1.3] Error 1
make: *** Waiting for unfinished jobs....
ln -s libpaho-mqtt3c.so.1.3  build/output/libpaho-mqtt3c.so.1
ln -s libpaho-mqtt3c.so.1 build/output/libpaho-mqtt3c.so
/lib/../lib/libcrypto.so: file not recognized: File format not recognized
collect2: error: ld returned 1 exit status
Makefile:278: recipe for target &#39;build/output/libpaho-mqtt3as.so.1.3&#39; failed
make: *** [build/output/libpaho-mqtt3as.so.1.3] Error 1
ln -s libpaho-mqtt3a.so.1.3  build/output/libpaho-mqtt3a.so.1
ln -s libpaho-mqtt3a.so.1 build/output/libpaho-mqtt3a.so
</code></pre>
<p>不要惊慌，报错信息在提示我们&#x2F;lib&#x2F;..&#x2F;lib&#x2F;libcrypto.so: file not recognized: File format not recognized，也有可能是&#x2F;lib&#x2F;..&#x2F;lib&#x2F;libssl.so。首先我们去查看一下这两个文件类型是什么样的：</p>
<p>运行locate命令定位链接库文件位置：</p>
<pre><code>locate libssl.so
-&gt;  /usr/lib/x86_64-linux-gnu/libssl.so.1.0.0
    /usr/lib/x86_64-linux-gnu/libssl.so.1.1
</code></pre>
<p>运行file命令查看文件类型</p>
<pre><code>file /lib/libssl.so
-&gt; /lib/libssl.so: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, BuildID[sha1]=27aee7be3c71555217d5a7f70a791405eca003bd, not stripped
</code></pre>
<p>（libcrypto.so同理同样是x86-64指令集的）</p>
<p>这么一来，交叉编译肯定是走不通，因为ARM指令集和x86指令集不同。所以我们需要ARM架构的libssl.so, libcrypto.so。</p>
<h3 id="3-openssl交叉编译安装-arm-linux-gnueabihf"><a href="#3-openssl交叉编译安装-arm-linux-gnueabihf" class="headerlink" title="3. openssl交叉编译安装(arm-linux-gnueabihf)"></a>3. openssl交叉编译安装(arm-linux-gnueabihf)</h3><p>在用户根目录下(<code>/home/&#123;$USER&#125;/</code>)下载openssl1.1.1v release版本</p>
<pre><code>wget https://github.com/openssl/openssl/releases/download/OpenSSL_1_1_1v/openssl-1.1.1v.tar.gz
tar xvf openssl-1.1.1v.tar.gz
cd openssl-1.1.1v/
</code></pre>
<p>执行以下命令生成指定编译链的Makefile:</p>
<pre><code>./config no-asm shared no-async --prefix=$(pwd)/install --cross-compile-prefix=arm-linux-gnueabihf-
</code></pre>
<p>参数说明：</p>
<pre><code>no-asm:  在交叉编译过程中不使用汇编代码代码加速编译过程；
 
shared: 生成动态连接库。
 
no-async: 交叉编译工具链没有提供GNU C的ucontext库
 
–prefix=: 安装路径
 
–cross-compile-prefix=: 交叉编译工具
</code></pre>
<p>进入Makefile，删除所有的’-m64’</p>
<pre><code>vim Makefile
</code></pre>
<pre><code>:/m64 找到之后删除，保存Esc-&gt;:wq
</code></pre>
<p>编译openssl</p>
<pre><code>make
</code></pre>
<p>文件夹里会多出几个动态链接库以及他们的软链接：</p>
<pre><code> ericzh@DESKTOP-EMLOSHV:~/openssl-1.1.1v ls
ACKNOWLEDGEMENTS  LICENSE        NOTES.WIN      config         external          libssl.a       pod2htmd.tmp   
AUTHORS           Makefile       README         config.com     fuzz              libssl.map     ssl
CHANGES           NEWS           README.ENGINE  configdata.pm  include           libssl.pc      test
CONTRIBUTING      NOTES.ANDROID  README.FIPS    crypto         libcrypto.a       libssl.so      tools
Configurations    NOTES.DJGPP    VMS            demos          libcrypto.map     libssl.so.1.1  util
Configure         NOTES.PERL     apps           doc            libcrypto.pc      ms             wycheproof     
FAQ               NOTES.UNIX     appveyor.yml   e_os.h         libcrypto.so      openssl.pc
INSTALL           NOTES.VMS      build.info     engines        libcrypto.so.1.1  os-dep
</code></pre>
<p>将生成的两个动态链接库复制到&#x2F;lib中，并将之前的x86架构的链接库另存为.save文件以备不时之需（万一哪天想用了找不到）</p>
<pre><code>cd /lib
sudo mv libcrypto.so libcrypto.so.save
sudo mv libcrypto.so.3 libcrypto.so.3.save
sudo cp /home/&#123;$USER&#125;/openssl-arm/lib/libcrypto.so /lib
sudo mv libssl.so libssl.so.save
sudo mv libssl.so.3  libssl.so.3.save
sudo cp /home/ericzh/openssl-arm/lib/libssl.so /lib
</code></pre>
<p>回到paho.mqtt工程中进行编译</p>
<pre><code>cd ~/paho_test/workspace/mqtt/paho.mqtt.c
make clean
make -j 16
---&gt;
mkdir -p build/output/samples
mkdir -p build/output/test
mkdir -p build
echo OSTYPE is Linux
sed -e &quot;s/@CLIENT_VERSION@/1.3.13/g&quot; -e &quot;s/@BUILD_TIMESTAMP@/Mon Apr 29 12:37:39 CST 2024/g&quot; src/VersionInfo.h.in &gt; build/VersionInfo.h
OSTYPE is Linux
arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3c.so.1.3 src/Heap.c src/LinkedList.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c src/MQTTClient.c  -shared -Wl,-init,MQTTClient_init -Wl,--start-group -pthread -lanl -Wl,--end-group -Wl,-soname,libpaho-mqtt3c.so.1
# arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3cs.so.1.3 src/Heap.c src/LinkedList.c src/SSLSocket.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c src/MQTTClient.c -DOPENSSL  -shared -Wl,--start-group -pthread -lanl -ldl -lssl -lcrypto -Wl,--end-group -Wl,-init,MQTTClient_init -Wl,-soname,libpaho-mqtt3cs.so.1 -Wl,-no-whole-archive
arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3a.so.1.3 src/Heap.c src/LinkedList.c src/MQTTAsyncUtils.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/MQTTAsync.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c  -shared -Wl,-init,MQTTAsync_init -Wl,--start-group -pthread -lanl -Wl,--end-group -Wl,-soname,libpaho-mqtt3a.so.1
# arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3as.so.1.3 src/Heap.c src/LinkedList.c src/SSLSocket.c src/MQTTAsyncUtils.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/MQTTAsync.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c -DOPENSSL  -shared -Wl,--start-group -pthread -lanl -ldl -lssl -lcrypto -Wl,--end-group -Wl,-init,MQTTAsync_init -Wl,-soname,libpaho-mqtt3as.so.1 -Wl,-no-whole-archive
arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3cs.so.1.3 src/Heap.c src/LinkedList.c src/SSLSocket.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c src/MQTTClient.c  -shared -Wl,--start-group -pthread -lanl -ldl -lssl -lcrypto -Wl,--end-group -Wl,-init,MQTTClient_init -Wl,-soname,libpaho-mqtt3cs.so.1 -Wl,-no-whole-archive
arm-linux-gnueabihf-gcc -g -fPIC  -D_GNU_SOURCE -Os -Wall -fvisibility=hidden -Ibuild -DPAHO_MQTT_EXPORTS=1 -o build/output/libpaho-mqtt3as.so.1.3 src/Heap.c src/LinkedList.c src/SSLSocket.c src/MQTTAsyncUtils.c src/MQTTProtocolClient.c src/MQTTProtocolOut.c src/MQTTAsync.c src/SHA1.c src/MQTTPersistence.c src/MQTTProperties.c src/MQTTPersistenceDefault.c src/Messages.c src/MQTTTime.c src/MQTTPacketOut.c src/Socket.c src/WebSocket.c src/Clients.c src/OsWrapper.c src/Thread.c src/MQTTPacket.c src/Base64.c src/Log.c src/StackTrace.c src/MQTTReasonCodes.c src/utf-8.c src/SocketBuffer.c src/Proxy.c src/Tree.c  -shared -Wl,--start-group -pthread -lanl -ldl -lssl -lcrypto -Wl,--end-group -Wl,-init,MQTTAsync_init -Wl,-soname,libpaho-mqtt3as.so.1 -Wl,-no-whole-archive
src/WebSocket.c:124:13: warning: ‘uuid_unparse’ defined but not used [-Wunused-function]
 static void uuid_unparse( uuid_t uu, char *out )
             ^~~~~~~~~~~~
src/WebSocket.c:124:13: warning: ‘uuid_unparse’ defined but not used [-Wunused-function]
 static void uuid_unparse( uuid_t uu, char *out )
             ^~~~~~~~~~~~
src/WebSocket.c:124:13: warning: ‘uuid_unparse’ defined but not used [-Wunused-function]
 static void uuid_unparse( uuid_t uu, char *out )
             ^~~~~~~~~~~~
src/WebSocket.c:124:13: warning: ‘uuid_unparse’ defined but not used [-Wunused-function]
 static void uuid_unparse( uuid_t uu, char *out )
             ^~~~~~~~~~~~
ln -s libpaho-mqtt3c.so.1.3  build/output/libpaho-mqtt3c.so.1
ln -s libpaho-mqtt3c.so.1 build/output/libpaho-mqtt3c.so
arm-linux-gnueabihf-gcc  -DNOSTACKTRACE -DNOLOG_MESSAGES src/Thread.c -g -o build/output/test/test1 src/../test/test1.c -lpaho-mqtt3c  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -DNOSTACKTRACE -DNOLOG_MESSAGES src/Thread.c -g -o build/output/test/test15 src/../test/test15.c -lpaho-mqtt3c  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -DNOSTACKTRACE -DNOLOG_MESSAGES src/Thread.c -g -o build/output/test/test2 src/../test/test2.c -lpaho-mqtt3c  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -DNOSTACKTRACE -DNOLOG_MESSAGES src/Thread.c -g -o build/output/test/sync_client_test src/../test/sync_client_test.c -lpaho-mqtt3c  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -DNOSTACKTRACE -DNOLOG_MESSAGES src/Thread.c -g -o build/output/test/test_mqtt4sync src/../test/test_mqtt4sync.c -lpaho-mqtt3c  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output   
arm-linux-gnueabihf-gcc  -DNOSTACKTRACE -DNOLOG_MESSAGES src/Thread.c -g -o build/output/test/test10 src/../test/test10.c -lpaho-mqtt3c  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
ln -s libpaho-mqtt3cs.so.1.3  build/output/libpaho-mqtt3cs.so.1
ln -s libpaho-mqtt3cs.so.1 build/output/libpaho-mqtt3cs.so
arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTClient_publish src/samples/MQTTClient_publish.c -lpaho-mqtt3cs  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTClient_publish_async src/samples/MQTTClient_publish_async.c -lpaho-mqtt3cs  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTClient_subscribe src/samples/MQTTClient_subscribe.c -lpaho-mqtt3cs  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -o build/output/samples/paho_cs_pub src/samples/paho_cs_pub.c -lpaho-mqtt3cs  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output src/samples/pubsub_opts.c
arm-linux-gnueabihf-gcc  -o build/output/samples/paho_cs_sub src/samples/paho_cs_sub.c -lpaho-mqtt3cs  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output src/samples/pubsub_opts.c
arm-linux-gnueabihf-gcc  -g -o build/output/test/test3 src/../test/test3.c -lpaho-mqtt3cs  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output
# arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTClient_publish src/samples/MQTTClient_publish.c -lpaho-mqtt3cs
# arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTClient_publish_async src/samples/MQTTClient_publish_async.c -lpaho-mqtt3cs
# arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTClient_subscribe src/samples/MQTTClient_subscribe.c -lpaho-mqtt3cs
# arm-linux-gnueabihf-gcc  -o build/output/samples/paho_cs_pub src/samples/paho_cs_pub.c -lpaho-mqtt3cs src/samples/pubsub_opts.c
# arm-linux-gnueabihf-gcc  -o build/output/samples/paho_cs_sub src/samples/paho_cs_sub.c -lpaho-mqtt3cs src/samples/pubsub_opts.c
# arm-linux-gnueabihf-gcc  -g -o build/output/test/test3 src/../test/test3.c -lpaho-mqtt3cs
ln -s libpaho-mqtt3a.so.1.3  build/output/libpaho-mqtt3a.so.1
ln -s libpaho-mqtt3a.so.1 build/output/libpaho-mqtt3a.so
arm-linux-gnueabihf-gcc  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output -o build/output/paho_c_version -lpaho-mqtt3a src/MQTTVersion.c -ldl
arm-linux-gnueabihf-gcc  -g -o build/output/test/test4 src/../test/test4.c -lpaho-mqtt3a  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -g -o build/output/test/test45 src/../test/test45.c -lpaho-mqtt3a  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -g -o build/output/test/test6 src/../test/test6.c -lpaho-mqtt3a  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -g -o build/output/test/test9 src/../test/test9.c -lpaho-mqtt3a  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -g -o build/output/test/test95 src/../test/test95.c -lpaho-mqtt3a  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -g -o build/output/test/test_mqtt4async src/../test/test_mqtt4async.c -lpaho-mqtt3a  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -g -o build/output/test/test11 src/../test/test11.c -lpaho-mqtt3a  -I src -Wl,--start-group -pthread -lanl -Wl,--end-group -L build/output
ln -s libpaho-mqtt3as.so.1.3  build/output/libpaho-mqtt3as.so.1
ln -s libpaho-mqtt3as.so.1 build/output/libpaho-mqtt3as.so
arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTAsync_subscribe src/samples/MQTTAsync_subscribe.c -lpaho-mqtt3as  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTAsync_publish src/samples/MQTTAsync_publish.c -lpaho-mqtt3as  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output
arm-linux-gnueabihf-gcc  -o build/output/samples/paho_c_pub src/samples/paho_c_pub.c -lpaho-mqtt3as  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output src/samples/pubsub_opts.c
arm-linux-gnueabihf-gcc  -o build/output/samples/paho_c_sub src/samples/paho_c_sub.c -lpaho-mqtt3as  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output src/samples/pubsub_opts.c
arm-linux-gnueabihf-gcc  -g -o build/output/test/test5 src/../test/test5.c -lpaho-mqtt3as  -I src -Wl,--start-group -pthread -lanl -lssl -lcrypto -Wl,--end-group -L build/output
# arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTAsync_subscribe src/samples/MQTTAsync_subscribe.c -lpaho-mqtt3as
# arm-linux-gnueabihf-gcc  -o build/output/samples/MQTTAsync_publish src/samples/MQTTAsync_publish.c -lpaho-mqtt3as
# arm-linux-gnueabihf-gcc  -o build/output/samples/paho_c_sub src/samples/paho_c_sub.c -lpaho-mqtt3as src/samples/pubsub_opts.c
# arm-linux-gnueabihf-gcc  -o build/output/samples/paho_c_pub src/samples/paho_c_pub.c -lpaho-mqtt3as src/samples/pubsub_opts.c
# arm-linux-gnueabihf-gcc  -g -o build/output/test/test5 src/../test/test5.c -lpaho-mqtt3as
</code></pre>
<p>编译成功（撒花！！！<em>★,°</em>:.☆(￣▽￣)&#x2F;$:<em>.°★</em> 。）</p>
<p>进入build目录中，可以看到生成了一个新的output文件夹，里面存放的就是我们需要的动态链接库啦</p>
<pre><code>cd build/
ls
---&gt; VersionInfo.h  output
cd output/
ls
---&gt;
libpaho-mqtt3a.so    libpaho-mqtt3a.so.1.3  libpaho-mqtt3as.so.1    libpaho-mqtt3c.so    libpaho-mqtt3c.so.1.3  libpaho-mqtt3cs.so.1    paho_c_version  test
libpaho-mqtt3a.so.1  libpaho-mqtt3as.so     libpaho-mqtt3as.so.1.3  libpaho-mqtt3c.so.1  libpaho-mqtt3cs.so 
</code></pre>
<p>随便看一个文件</p>
<pre><code>file libpaho-mqtt3a.so.1.3
---&gt;
libpaho-mqtt3a.so.1.3: ELF 32-bit LSB shared object, ARM, EABI5 version 1 (SYSV), dynamically linked, BuildID[sha1]=9127172e087d577670530e0c86d2fb337b159de0, with debug_info, not stripped
</code></pre>
<p>可以看到架构已经变成ARM了，证明了编译成功。</p>
<h3 id="4-测试程序编译与下板"><a href="#4-测试程序编译与下板" class="headerlink" title="4. 测试程序编译与下板"></a>4. 测试程序编译与下板</h3><p>在paho.mqtt.c&#x2F;build&#x2F;output中，将编译好的动态链接库打包，先传到本机，之后通过网线scp传到开发板</p>
<pre><code>cd ~/paho_test/workspace/mqtt/paho.mqtt.c/build/output
tar cf mqtt-arm-lib.tar ./libpaho-mqtt3*
cp mqtt-arm-lib.tar /mnt/d/ 
&lt;!-- 这里我选择先复制到D盘中 --&gt;
</code></pre>
<p>进入我们之前创建的mqtt_test工作环境中，开始编译测试程序</p>
<pre><code>cd ~/paho_test/workspace/mqtt_test 
arm-linux-gnueabihf-gcc MQTTClient_publish.c -o pub-arm.o
</code></pre>
<p>开发板上电，网线接好，IP地址配到同一网段，之后通过scp命令传输文件<br>（这里跳过文件传输，假设已经传输好，并且开发板能够通外网（需要无线网卡））</p>
<p>开发板petalinux环境中执行</p>
<pre><code>mkdir mqtt-arm-lib
mv mqtt-arm-lib.tar ./mqtt-arm-lib/
cd mqtt-arm-lib/
tar -xvf mqtt-arm-lib.tar
mv lib* /lib/
cd ~
chmod +x pub-arm.o
./pub-arm.o
---&gt; Failed to connect, return code -1 (没通网时会报错)
---&gt;
Waiting for up to 10 seconds for publication of Hello World!
on topic MQTT Examples for client with ClientID: 6620c62c2ccc1a583881d5fb_cc2530_0_0_2024042508
Message with delivery token 1 delivered  (正常输出)
</code></pre>
<p>至此，板端MQTT工程已移植完毕。</p>

        </div>

        
            <div class="post-copyright-info my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> ARM-Linux-MQTT移植</li>
        <li><strong>作者:</strong> Eric Zhang</li>
        <li><strong>创建于
                :</strong> 2024-04-30 00:03:50</li>
        
            <li>
                <strong>更新于
                    :</strong> 2024-04-30 02:38:13
            </li>
        
        <li>
            <strong>链接:</strong> https://ericzhang1412.github.io/2024/04/30/arm-linux-mqtt/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/MQTT/">#MQTT</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/ARM/">#ARM</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/ZYNQ/">#ZYNQ</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/Linux/">#Linux</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2024/04/30/FireFly-v1-FPGA-Simulation/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">FireFly-v1-FPGA Simulation</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2024/03/16/2023-NUEDC/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">2023_NUEDC</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container pjax">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fa-solid fa-comments"></i>&nbsp;评论
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://blog-comments-9q2oiy1rg-ericzhang1412.vercel.app/',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          requiredMeta: ['nick', 'mail']
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">此页目录</div>
        <div class="page-title">ARM-Linux-MQTT移植</div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9C%A8ZYNQ-7020-PS%E7%AB%AF%E4%BD%BF%E7%94%A8paho-mqtt%E5%AE%9E%E7%8E%B0%E8%AE%BE%E5%A4%87%E4%BE%A7%E5%BC%80%E5%8F%91%E8%BF%9E%E6%8E%A5%E5%8D%8E%E4%B8%BA%E4%BA%91IoTDA%E6%9C%8D%E5%8A%A1"><span class="nav-text">在ZYNQ 7020 PS端使用paho.mqtt实现设备侧开发连接华为云IoTDA服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-text">参考资料</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0-Ubuntu18-04-WSL%E5%87%86%E5%A4%87"><span class="nav-text">0. Ubuntu18.04 WSL准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%89%8D%E7%BD%AE%E5%8C%85%E5%87%86%E5%A4%87"><span class="nav-text">1. 前置包准备</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-text"></span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E4%B8%8E%E7%A7%BB%E6%A4%8D%E8%87%B3Zynq-7020-PS%E7%AB%AF%EF%BC%88%E5%9F%BA%E4%BA%8EPetalinux%EF%BC%89"><span class="nav-text">2. 交叉编译与移植至Zynq-7020 PS端（基于Petalinux）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-openssl%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85-arm-linux-gnueabihf"><span class="nav-text">3. openssl交叉编译安装(arm-linux-gnueabihf)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%B5%8B%E8%AF%95%E7%A8%8B%E5%BA%8F%E7%BC%96%E8%AF%91%E4%B8%8E%E4%B8%8B%E6%9D%BF"><span class="nav-text">4. 测试程序编译与下板</span></a></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Eric Zhang</a>
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.5.6</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>



    
<script src="/js/tools/localSearch.js" type="module"></script>




    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>




    
<script src="/js/libs/mermaid.min.js"></script>

    
<script src="/js/plugins/mermaid.js"></script>





<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/libs/anime.min.js"></script>

        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


    <div id="aplayer"></div>

<script src="/js/libs/APlayer.min.js"></script>


<script src="/js/plugins/aplayer.js"></script>


</body>
</html>
